# üìã REQUISITOS FUNCIONAIS - CONVERSOR EXCEL ‚Üí XML (BANCO DO BRASIL)

## üéØ OBJETIVO GERAL
Sistema desktop multiplataforma para converter planilhas Excel em arquivos XML no formato espec√≠fico do sistema de comandos de pagamento do Banco do Brasil.

## üñ•Ô∏è ESPECIFICA√á√ïES T√âCNICAS

### **Plataforma:**
- **Desktop nativo** (Windows, Linux, macOS)
- **N√ÉO web** - aplica√ß√£o standalone
- **N√ÉO usar navegador** - interface nativa
- **Multiplataforma** - mesmo c√≥digo para todos os OS

### **Tecnologias Sugeridas:**
- **Python** + Tkinter/PyQt/Kivy
- **Java** + JavaFX/Swing
- **C#** + .NET MAUI/Avalonia
- **Dart** + Flutter Desktop
- **Rust** + Tauri/egui
- **Go** + Fyne/Walk

## üìä FUNCIONALIDADES PRINCIPAIS

### **1. INTERFACE PRINCIPAL**

#### **Layout:**
- **Janela principal** 1400x900px (redimension√°vel, m√≠nimo 1200x700)
- **√Årea principal** (70%) + **Sidebar** (30%)
- **Header** com t√≠tulo "Conversor Excel ‚Üí XML - Sistema BB v2.0"

#### **Componentes Obrigat√≥rios:**
- **√Årea de upload** com drag-and-drop para Excel (.xlsx/.xls)
- **Campo texto:** Nome do arquivo XML de sa√≠da
- **Campo texto:** Folha no formato MMAAAA (ex: 062025)
- **Bot√£o convers√£o** grande e destacado
- **Barra de progresso** durante processamento
- **√Årea de mensagens** (sucesso/erro/info)
- **Sidebar** com gerenciamento de respons√°veis

### **2. GERENCIAMENTO DE RESPONS√ÅVEIS**

#### **Funcionalidades:**
- **Listar** respons√°veis cadastrados
- **Adicionar** novo respons√°vel
- **Editar** respons√°vel existente
- **Selecionar** respons√°vel para convers√£o
- **Alternar** entre modo simples (dropdown) e avan√ßado (lista)

#### **Campos do Respons√°vel:**
- **Nome completo** (obrigat√≥rio, at√© 100 chars)
- **CPF** (obrigat√≥rio, 11 d√≠gitos, apenas n√∫meros)
- **NIP** (obrigat√≥rio, at√© 20 chars)
- **Perfil** (dropdown: AGI, ADM, GER)
- **Tipo Perfil OM** (dropdown: IQM, SUP, ADM)
- **C√≥digo Papem** (padr√£o: 094)

#### **Valida√ß√µes:**
- **CPF:** Algoritmo de valida√ß√£o completo
- **Campos obrigat√≥rios:** n√£o podem estar vazios
- **CPF √∫nico:** n√£o permitir duplicatas
- **Formato:** nome em mai√∫sculas, CPF apenas n√∫meros

#### **Persist√™ncia:**
- **Arquivo JSON** local para armazenar respons√°veis
- **Backup autom√°tico** antes de salvar
- **Respons√°vel padr√£o** criado na primeira execu√ß√£o

### **3. PROCESSAMENTO DE EXCEL**

#### **Formato de Entrada:**
```
Colunas obrigat√≥rias:
- matricula: n√∫meros (ex: 10024450)
- rubrica: 7 d√≠gitos (ex: 1208000)  
- valor: decimal com ponto (ex: 12000.00)
- tipo: NO (normal) ou DE (desconto)
- trigrama: 3 letras (ex: BAA)
```

#### **Valida√ß√µes:**
- **Extens√µes:** .xlsx, .xls
- **Colunas:** verificar se todas obrigat√≥rias existem
- **Dados:** matricula/rubrica/valor n√£o vazios
- **Formato valor:** aceitar v√≠rgula ou ponto, converter para ponto
- **Tipo:** validar se √© NO ou DE
- **Contagem:** registros v√°lidos vs inv√°lidos

#### **Processamento:**
- **Leitura real** do arquivo Excel (n√£o dados fixos)
- **Limpeza:** trim em textos, formata√ß√£o de n√∫meros
- **Valida√ß√£o linha por linha** com relat√≥rio de erros
- **Contagem final** de registros processados

### **4. GERA√á√ÉO DE XML**

#### **Formato de Sa√≠da (CORRETO conforme arquivo resultado.txt):**
```xml
<?xml version="1.0" encoding="iso-8859-1" standalone="yes"?>
<ArquivoComandosPagamento>
  <sistema>3</sistema>
  <dtGeracao>26/06/2025 11:22:34</dtGeracao>
  <dtRemessa>26/06/2025 11:22:34</dtRemessa>
  <nome>ROGERIO RIBEIRO DE SOUZA</nome>
  <cpf>07328623705</cpf>
  <perfil>AGI</perfil>
  <tipoPerfilOM>IQM</tipoPerfilOM>
  <nip>05955645</nip>
  <codPapem>094</codPapem>
  <qtdeTotal>131</qtdeTotal>
  <folha>062025</folha>
  <listaTrigrama>
    <trigrama>
      <trigrama>BAA</trigrama>
      <listaComandosPagamento>
        <ComandoPagamento>
          <identificador>1</identificador>
          <matricula>10024450</matricula>
          <alterador>I</alterador>
          <rubrica>1208000</rubrica>
          <tpRubrica>NO</tpRubrica>
          <formPagto>AV</formPagto>
          <valComando>12000.00</valComando>
        </ComandoPagamento>
        <ComandoPagamento>
          <identificador>2</identificador>
          <matricula>10024450</matricula>
          <alterador>I</alterador>
          <rubrica>1210005</rubrica>
          <tpRubrica>DE</tpRubrica>
          <formPagto>AV</formPagto>
          <valComando>12000.00</valComando>
        </ComandoPagamento>
        <!-- Continua para todos os 131 registros -->
      </listaComandosPagamento>
    </trigrama>
  </listaTrigrama>
</ArquivoComandosPagamento>
```

#### **Diferen√ßas Importantes do Formato Real:**
- **SEM** `xmlns:xsi` attribute no elemento raiz
- **Estrutura simples:** tags diretas sem namespaces
- **Encoding:** iso-8859-1 obrigat√≥rio
- **Standalone:** yes
- **Data/hora:** formato brasileiro DD/MM/AAAA HH:MM:SS
- **Valores:** sempre com ponto decimal (ex: 12000.00)
- **qtdeTotal:** n√∫mero exato de registros processados (131 no exemplo)
- **trigrama aninhado:** elemento `<trigrama>` dentro de `<trigrama>`

#### **Regras de Neg√≥cio (CORRIGIDAS):**
- **XML Declaration:** `<?xml version="1.0" encoding="iso-8859-1" standalone="yes"?>`
- **Elemento raiz:** `<ArquivoComandosPagamento>` SEM atributos xmlns
- **dtGeracao/dtRemessa:** mesmo valor, formato brasileiro DD/MM/AAAA HH:MM:SS
- **sistema:** sempre "3"
- **alterador:** sempre "I"  
- **formPagto:** sempre "AV"
- **identificador:** sequencial come√ßando em 1
- **trigrama:** estrutura aninhada - `<trigrama><trigrama>BAA</trigrama>...</trigrama>`
- **encoding:** iso-8859-1 obrigat√≥rio
- **valores:** sempre formato decimal com ponto (ex: 12000.00, 3066.09)
- **qtdeTotal:** contar registros reais processados
- **tpRubrica:** NO para cr√©ditos, DE para d√©bitos
- **Exemplo real:** O arquivo deve gerar exatamente como o resultado.txt (131 registros)

### **5. FUNCIONALIDADES AUXILIARES**

#### **Arquivo de Refer√™ncia:**
O sistema deve gerar XML **exatamente** como o arquivo `resultado.txt` fornecido, que cont√©m:
- **131 registros** processados
- **Respons√°vel:** ROGERIO RIBEIRO DE SOUZA
- **Folha:** 062025 (junho/2025)
- **Data gera√ß√£o:** 26/06/2025 11:22:34
- **Trigrama:** BAA para todos os registros

#### **Estrutura Validada:**
- Diversos tipos de matr√≠culas (8 d√≠gitos)
- Rubricas variadas (1208000, 1210005, 1216018, etc.)
- Valores monet√°rios diversos (17.34 at√© 89736.85)
- Tipos NO (normal) e DE (desconto) intercalados
- Identificadores sequenciais de 1 a 131

#### **Padr√µes Observados:**
- **Matr√≠culas reais:** 10024450, 97115215, 98004450, 87275660, etc.
- **Rubricas comuns:** 1208000 (mais frequente), 1210005, 1216018, 1237005, etc.
- **Valores:** sempre 2 casas decimais, ponto como separador
- **Sequ√™ncia:** sem quebras, 1 a 131 consecutivo
- **Formata√ß√£o:** identa√ß√£o consistente com 2 espa√ßos

#### **Gera√ß√£o de Modelo Excel:**
- **Bot√£o** "Baixar Modelo Excel"
- **Arquivo .xlsx** com:
  - Aba "Comandos" com estrutura correta e exemplos
  - Aba "Instru√ß√µes" com manual de uso
  - Formata√ß√£o de colunas adequada
- **Di√°logo** para escolher local de salvamento

#### **A√ß√µes R√°pidas:**
- **Limpar formul√°rio:** resetar todos os campos
- **Ajuda:** modal com instru√ß√µes de uso
- **√öltimos processamentos:** hist√≥rico na sidebar

#### **Valida√ß√µes Gerais:**
- **Arquivo selecionado:** obrigat√≥rio
- **Respons√°vel selecionado:** obrigat√≥rio  
- **Nome XML:** obrigat√≥rio, extens√£o .xml
- **Folha:** obrigat√≥rio, formato MMAAAA
- **Bot√£o convers√£o:** habilitado apenas quando tudo v√°lido

## üé® INTERFACE E EXPERI√äNCIA

### **Design:**
- **Tema moderno:** cores azul/verde/vermelho para status
- **√çcones:** Unicode/Emoji para melhor identifica√ß√£o
- **Tipografia:** fonte system padr√£o, leg√≠vel
- **Layout responsivo:** adaptar a diferentes resolu√ß√µes

### **Estados Visuais:**
- **Upload √°rea:** normal/hover/com-arquivo
- **Bot√µes:** normal/hover/disabled
- **Campos:** normal/focus/erro
- **Mensagens:** sucesso (verde)/erro (vermelho)/info (azul)

### **Feedback ao Usu√°rio:**
- **Barra de progresso** durante convers√£o
- **Mensagens espec√≠ficas** para cada tipo de erro
- **Contadores:** registros processados/v√°lidos/inv√°lidos
- **Confirma√ß√µes:** antes de a√ß√µes destrutivas

## üîÑ FLUXO DE USO

### **Fluxo Principal:**
1. **Abrir aplica√ß√£o**
2. **Selecionar/cadastrar respons√°vel**
3. **Carregar arquivo Excel** (drag-drop ou bot√£o)
4. **Verificar dados** processados (contagem)
5. **Definir nome XML** e folha
6. **Converter** (com progresso)
7. **Salvar XML** no local escolhido
8. **Confirmar sucesso** com detalhes

### **Fluxos Alternativos:**
- **Baixar modelo** antes de criar planilha
- **Gerenciar respons√°veis** via modal/sidebar
- **Ver ajuda** sobre formato dos dados
- **Corrigir erros** de valida√ß√£o

## ‚ö†Ô∏è TRATAMENTO DE ERROS

### **Valida√ß√µes Obrigat√≥rias:**
- **Arquivo Excel:** extens√£o, colunas, dados v√°lidos
- **Respons√°vel:** CPF, campos obrigat√≥rios
- **Formul√°rio:** campos preenchidos corretamente
- **Sistema:** permiss√µes de arquivo, espa√ßo em disco

### **Mensagens de Erro:**
- **Espec√≠ficas:** explicar exatamente o problema
- **Acion√°veis:** sugerir como resolver
- **Contextuais:** mostrar qual campo/linha tem erro
- **Recuper√°veis:** permitir corre√ß√£o sem perder dados

## üíæ PERSIST√äNCIA DE DADOS

### **Arquivo de Configura√ß√£o (JSON):**
```json
{
  "versao": "2.0",
  "ultimaAtualizacao": "2025-07-08T10:30:00Z",
  "responsaveis": [
    {
      "id": 1,
      "nome": "FULANO DE TAL",
      "cpf": "12345678901",
      "nip": "12345",
      "perfil": "AGI",
      "tipoPerfilOM": "IQM",
      "codPapem": "094",
      "ativo": true,
      "dataCadastro": "2025-01-01T00:00:00Z"
    }
  ]
}
```

### **Localiza√ß√£o:**
- **Windows:** %APPDATA%/ConversorExcelXML/
- **Linux:** ~/.config/conversorexcelxml/
- **macOS:** ~/Library/Application Support/ConversorExcelXML/

## üöÄ CRIT√âRIOS DE ACEITA√á√ÉO

### **Funcionais:**
- ‚úÖ Ler arquivos Excel reais (.xlsx/.xls)
- ‚úÖ Validar todos os campos obrigat√≥rios
- ‚úÖ Gerar XML no formato exato especificado
- ‚úÖ Gerenciar respons√°veis com CRUD completo
- ‚úÖ Interface intuitiva e responsiva
- ‚úÖ Funcionar em Windows, Linux e macOS

### **N√£o-Funcionais:**
- ‚úÖ Tempo resposta < 5 segundos para arquivos at√© 1000 registros
- ‚úÖ Uso de mem√≥ria < 100MB durante processamento
- ‚úÖ Interface responsiva (sem travamentos)
- ‚úÖ Arquivos de at√© 10MB suportados
- ‚úÖ Inicializa√ß√£o < 3 segundos

### **Qualidade:**
- ‚úÖ Zero perda de dados durante convers√£o
- ‚úÖ Valida√ß√£o 100% conforme especifica√ß√£o BB
- ‚úÖ Tratamento de erros robusto
- ‚úÖ Interface consistente entre plataformas
- ‚úÖ Backup autom√°tico de configura√ß√µes

## üìÅ ENTREG√ÅVEIS

1. **Aplica√ß√£o compilada** para Windows, Linux, macOS
2. **Instaladores nativos** para cada plataforma
3. **Manual do usu√°rio** em PDF
4. **Modelo Excel** de exemplo
5. **C√≥digo fonte** documentado

## üéØ RESULTADO ESPERADO

Sistema desktop nativo, multiplataforma, que substitui solu√ß√µes legadas .exe, com interface moderna e intuitiva, processamento robusto de dados Excel e gera√ß√£o precisa de XML conforme especifica√ß√µes do Banco do Brasil.